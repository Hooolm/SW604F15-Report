%!TEX root = ../../../super_main.tex

\section{Memory Issue Workaround Solution}
\label{sec:memory_issue_workaround_solution}

As mentioned in \secref{sec:memory_issues}, there was an issue with bitmaps being kept in memory even when the object displaying the bitmap was deallocated collected. We developed a workaround for this, which was a temporary solution for the \androidinline{GirafPictogramItemView}. As also mentioned in the section, we orientated the database groups about this, and proposed a solution. \\

As of the last week of sprint 4, one database group had implemented a solution somewhat similar to the one we proposed. Previously the database entities that subclassed the \androidinline{BasicImageModel} class had the getImage and setImage methods, which would eventually cause a memory leak. \\

This class has now been removed and instead replaced with an \androidinline{ImageEntity} interface which database abstraction classes with a image should now implement. This \androidinline{ImageEntity} is then used with a new \androidinline{BasicImageControllerHelper} database class. This helper has methods that expect an \androidinline{ImageEntity} as input, and it can then, based on the specific type of this input, perform actions on the input's corresponding image, e.g. get the image of a \androidinline{Pictogram}. \\

This makes sure that references to bitmaps are not kept by the objects implementing \androidinline{ImageEntity}, and instead a bitmap reference is returned to the calling object which called the getImage method on the \androidinline{BasicImageHelper}. This allows us to bind the bitmaps to the \androidinline{View} which is supposed to show the bitmap, and not the object which implements the \androidinline{ImageEntity}. This allows us to deallocate bitmaps once they are no longer shown in the GUI independent of the objects implementing \androidinline{ImageEntity}. This should thereby resolve the memory issues that were present previously. 